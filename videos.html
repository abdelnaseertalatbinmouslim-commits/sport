<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Library | ASU Sport</title>
    <style>
        body { background: #020617; color: white; font-family: 'Segoe UI', sans-serif; padding: 40px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        .card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 15px; backdrop-filter: blur(10px); }
        iframe { width: 100%; height: 200px; border-radius: 12px; border: none; }
        h3 { margin: 15px 0; color: #38bdf8; }
        .btn-doc { display: inline-block; padding: 8px 15px; background: #38bdf8; color: #000; text-decoration: none; border-radius: 8px; font-weight: bold; font-size: 0.9rem; }
    </style>
</head>
<body>
    <h1>ðŸŽ¥ Video Lectures</h1>
    <div class="grid" id="videoContainer">Loading lectures...</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyARFFCmCE76J9bGeZqzBBrsBDHeIBI3RT8",
          authDomain: "asu-sport-science.firebaseapp.com",
          projectId: "asu-sport-science",
          storageBucket: "asu-sport-science.firebasestorage.app",
          messagingSenderId: "303252122675",
          appId: "1:303252122675:web:2865bfa8732b1e05254746",
          measurementId: "G-MEL24095E3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const container = document.getElementById('videoContainer');

        const q = query(collection(db, "lectures"), orderBy("timestamp", "desc"));

        onSnapshot(q, (snapshot) => {
            container.innerHTML = '';
            snapshot.forEach((doc) => {
                const data = doc.data();
                // Convert YouTube URL to Embed URL
                const videoId = data.videoUrl.split('v=')[1] || data.videoUrl.split('/').pop();
                const embedUrl = `https://www.youtube.com/embed/${videoId}`;

                container.innerHTML += `
                    <div class="card">
                        <iframe src="${embedUrl}" allowfullscreen></iframe>
                        <h3>${data.title}</h3>
                        <a href="${data.driveUrl}" target="_blank" class="btn-doc">Download Materials</a>
                    </div>
                `;
            });
        });
    </script>
</body>
</html>
